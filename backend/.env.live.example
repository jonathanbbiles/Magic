APCA_API_KEY_ID=YOUR_ALPACA_KEY_ID
APCA_API_SECRET_KEY=YOUR_ALPACA_SECRET_KEY
# Alternate key envs also supported:
# ALPACA_KEY_ID, ALPACA_API_KEY_ID, ALPACA_API_KEY
# Alternate secret envs also supported:
# ALPACA_SECRET_KEY, ALPACA_API_SECRET_KEY
# Use either ALPACA_API_BASE or TRADE_BASE for live trading.
TRADE_BASE=https://api.alpaca.markets
# ALPACA_API_BASE=https://api.alpaca.markets
DATA_BASE=https://data.alpaca.markets
TRADING_ENABLED=true
MAX_CONCURRENT_POSITIONS=3
API_TOKEN=CHANGE_ME_TO_A_LONG_RANDOM_STRING
# Optional: allow LAN/device origins for Expo.
CORS_ALLOW_LAN=true
# === Exits & Risk ===
SELL_REPRICE_ENABLED=1
EXIT_CANCELS_ENABLED=1
EXIT_MARKET_EXITS_ENABLED=1
ALLOW_TAKER_BEFORE_TARGET=1
# Faster rotation / less stale orders:
SELL_ORDER_TTL_MS=15000
MIN_REPRICE_INTERVAL_MS=15000
REPRICE_IF_AWAY_BPS=6
MAX_HOLD_SECONDS=300
# Safety: default OFF, but available:
EXIT_CANCELS_FORCE_ALL=0

# Alpaca market-data throttling (helps avoid HTTP 429 on bars)
BARS_MAX_CONCURRENT=2
BARS_MIN_TIME_MS=300
ENTRY_PREFETCH_CHUNK_SIZE=80
ALPACA_MD_MAX_CONCURRENCY=2
ALPACA_MD_MIN_DELAY_MS=200
ALPACA_MD_MAX_RETRIES=6
ALPACA_MD_BASE_BACKOFF_MS=500
ALPACA_BARS_USE_TIME_RANGE=true
BARS_PREFETCH_INTERVAL_MS=60000
ALLOW_PER_SYMBOL_BARS_FALLBACK=false
PER_SCAN_BARS_FALLBACK_BUDGET=2

# --- Entry tuning ---
# Predictor threshold. Your model outputs ~0.53 frequently; 0.55 starves entries.
MIN_PROB_TO_ENTER=0.53
# Predictor gating:
# TP-aligned move target in bps (this is what you actually take profit on; e.g. 60-90)
ENTRY_TAKE_PROFIT_BPS=70

# Stretch confidence move target in bps (this is what you "want to see" for confidence; e.g. 100-150)
ENTRY_STRETCH_MOVE_BPS=100

# Entry gate uses TP probability threshold
MIN_PROB_TO_ENTER_TP=0.53

# Optional second confidence filter; 0 disables it
MIN_PROB_TO_ENTER_STRETCH=0

# Entry-side gross take-profit target (bps). Defaults to DESIRED_NET_PROFIT_BASIS_POINTS if unset.
TARGET_PROFIT_BPS=100

# Stop-loss (bps). If unset, backend scales from TARGET_PROFIT_BPS; override here if desired.
STOP_LOSS_BPS=50

# Entry buffer (bps) added into spread gate only (small sanity margin)
ENTRY_BUFFER_BPS=10

# EV guard (corrected to maker-first fees via feeBpsRoundTrip()).
EV_GUARD_ENABLED=true
EV_MIN_BPS=5
EV_BUFFER_BPS=0

# Fees (bps). feeBpsRoundTrip() = maker + (taker_on_touch ? taker : maker)
FEE_BPS_MAKER=10
FEE_BPS_TAKER=20

# Optional slippage (bps) added to EV cost model
SLIPPAGE_BPS=0

STOPS_ENABLED=1
STOPLOSS_ENABLED=1
STOPLOSS_MODE=atr

# Optional safety hard timeout: force-close positions older than 1 hour.
# FORCE_EXIT_SECONDS=3600
# FORCE_EXIT_ALLOW_LOSS=1
